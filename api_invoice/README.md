# 接口
## 文件
## base64数据
## url地址
# 实现

- 校验调用方的合法性
- 不管传入的是什么类型的文件,都将转换为本地文件存储
- 对源文件进行一次备份
- 对文件进行横竖的处理,竖的转换为横向的(这里要求图片的横竖方向与发票的横竖方向一致)
    - TODO 图片的方向与发票方向不一致
- 对图片的发票内容对应的大框进行选中抽出,并且矫正方向为各角度为90度的矩形
- 对图片进行大小的缩放,缩放到统一的大小,目前是2048
- 然后对图片内容区域镜像切割,将关键数据区域切出来单独图片单独存储,切割的时候会切两份出来,分为正反两种
    - 身份证/机构代码
    - 发动机号码
    - vin号码
- 对各个图片进行识别
    - 方案一: tesseract
        - 先对原图进行识别
        - 如果前面步骤没有识别出来,再使用历史阈值进行二值化处理的图片识别
        - 如果前面步骤没有识别出来,再遍历阈值范围内所有阈值来尝试识别
        - 识别过程中会对不同的信息进行校验,校验通过才算识别成功
        - 如果都没识别出来,返回原图识别的结果
    - 方案二: 机器图片识别
        -对原图进行文字定位分析
        -将文字区域切割出来单独存储
        -将文字单独识别再进行校验
- TODO 异步存储数据到数据库和分布式文件系统
- TODO 发布脚本

~/venv3.6/bin/python ~/project/PJ_DATA_IMG/api_invoice/main.py

~/venv3.6/bin/python ~/project/PJ_DATA_IMG/api_invoice/test.py